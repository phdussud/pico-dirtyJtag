import usb1
import time

VID = 0x1209
PID = 0xC0CA
EP_OUT = 0x01
EP_IN  = 0x82

def send_cmd(handle, data):
    handle.bulkWrite(EP_OUT, data)
    try:
        resp = handle.bulkRead(EP_IN, 64, timeout=100)
        print("IN:",resp, "Len:", len(resp))
    except usb1.USBErrorTimeout:
        print("No IN response")

def main():
    ctx = usb1.USBContext()
    handle = ctx.openByVendorIDAndProductID(VID, PID,
                                            skip_on_error=True)
    if handle is None:
        print("Device not found")
        return
    with handle.claimInterface(0):

        to_send = bytes([0x1, 0x0])
        send_cmd(handle, to_send)

        to_send = bytes([0x2, 0x3, 0xe8, 0x0])
        send_cmd(handle, to_send)

        to_send = bytes([0x4, 0x60, 0x60, 0x0])
        send_cmd(handle, to_send)
        
        to_send = bytes([0x6, 0x10, 0x7, 0x0])
        send_cmd(handle, to_send)

        to_send = bytes([0x6, 0x10, 0x3, 0x6, 0x0, 0x1, 0x6, 0x10, 0x1, 0x6, 0x0, 0x2, 0x0])
        send_cmd(handle, to_send)

        to_send = bytes([0x43, 0xf0, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
                         0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
                         0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 
                         0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff])
        send_cmd(handle, to_send)
        
        to_send = bytes([0x3, 0xaf, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
                         0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x86, 0x14, 0x1, 0x6, 0x0, 0x1, 0x6, 0x10, 0x7,
                         0x0])
        send_cmd(handle, to_send)

        to_send = bytes([0x6, 0x10, 0x2, 0x6, 0x0, 0x1, 0x6, 0x10, 0x2, 0x6, 0x0, 0x2, 0x3, 0xf, 0xff, 0xff, 0x86, 0x14,
                         0x1, 0x6, 0x10, 0x1, 0x6, 0x0, 0x1, 0x0])
        send_cmd(handle, to_send)

        to_send = bytes([0x6, 0x10, 0x2, 0x6, 0x0, 0x2, 0x83, 0xd, 0xff, 0xd4, 0x6, 0x14, 0x1, 0x6, 0x10, 0x1,
                         0x6, 0x0, 0x1, 0x6, 0x10, 0x1, 0x6, 0x0, 0x2, 0x3, 0x23, 0x10, 0x0, 0x0, 0x0, 0x0,
                         0x86, 0x10, 0x1, 0x6, 0x10, 0x1, 0x6, 0x0, 0x1, 0x6, 0x10, 0x1, 0x6, 0x0, 0x2, 0x3,
                         0x23, 0x24, 0x40, 0x0, 0x0, 0xa0, 0x86, 0x10, 0x1, 0x6, 0x10, 0x1, 0x6, 0x0, 0x1, 0x0])
        send_cmd(handle, to_send)

if __name__ == "__main__":
    main()
